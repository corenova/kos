# User's Guide

This documentation provides information on interacting with [Kinetic Reactor](./intro.md#kinetic-reactor) modules utilizing the `kos` CLI utility.

The `kos` utility provides an **interactive-prompt** interface for operating a running instance of the `kos` process. You can think of `kos` similarly to `node`, with the key difference being that instead of interacting with the JavaScript runtime, you are interacting with the [KOS runtime](#operating-system). You can also use `kos` *non-interactively* by supplying various arguments during execution of the CLI utility.  See [kos --help](#kos-help) for more details.

## Getting Started

The quickest way to get started with **KOS** is to start the `kos` program and begin interacting with it.
```
$ kos
kos>
load       load/path  process    program    prompt     reactor    read       require    show       .info      .help      .quit      
```
The above output is generated when you press `<TAB>` for auto-completion after entering the `kos` interactive shell.

Usually, the first **data token** you supply into the **KOS** runtime instance is the `load` token, which is used to *load* additional reactors into itself from the local filesystem.

### Loading Reactors

Using **KOS** you can dynamically `load` reactors into itself at any time.  When you start the `kos` utility, the [run](../reactors/run.md) reactor is loaded as one of the reactors for the **KOS** operating environment.

The `kos` utility allows you to pass in one or more reactors as arguments during instantiation:
```
$ kos sync http
kos> 
http/listen          http/request         http/request/get     http/route           http/server          http/server/request  link/stream          load
load/path            process              program              prompt               reactor              read                 require              show
sync/connect         sync/listen          .info                .help                .quit                
```
You can also `load` after entering the `kos` interactive shell (see [Sending Tokens](#sending-tokens)):
```
$ kos
kos> load "sync"
kos> load "http"
kos>
```
As you `load` more reactors into **KOS**, the runtime automatically attains additional *reactions* that it can perform.  Pressing `<TAB>` from the prompt gives you a listing of currently possible **tokens** that the runtime can react to.

The ability to `load` additional reactors from the local file system at any time provides **KOS** with *unbounded* adaptive characteristics. The `load` token can also be sent to the **KOS** instance from a remote source.

From the `kos>` prompt, you can also use the `.info` command to check the state of all internally loaded reactors at any time.

### Sending Tokens

When you interact with the `kos>` prompt, you are sending **data tokens** that the underlying **KOS** runtime can react to.  If you send in a **token** that it doesn't recognize, you will get back an *error* token as a response.

The **data token** in the `kos` interactive prompt is expressed using **KSON** (Kinetic Stream Object Notation).  It is basically JSON but *prefixed* with a single *token string* which is used as a **label** to describe the data.

Here are some examples of KSON expressions (where `foo` is the keyword):
```
foo "bar" // valid
foo { } // valid
foo [ ] // valid
foo { "bar": true } // valid

foo bar // invalid
foo // invalid
```

When you send a **data token** with a specific label, every [Kinetic Reactor](./intro.md#kinetic-reactor) that includes a *trigger* for that particular *token* will process that *token* and attempt to perform a *reaction*.


## Operating System 

The **KOS** runtime is an operating environment where one or more [Kinetic Reactor](./intro.md#kinetic-reactor) modules are *loaded and reacting* to the running environment.

The [run](../reactors/run.md) reactor provides runtime context reactions to the Node.js `process` object as well as `program` object that captures the CLI arguments.  It's worth taking the time to understand how the [run](../reactors/run.md) reactor works.

## kos commands

### kos --help

```
  Usage: kos [options] <reactors...>

  Options:

    -h, --help         output usage information
    -V, --version      output the version number
    -e, --expr <kson>  eval KSON expression and feed into KOS
    -d, --data <file>  feed KSON file contents into KOS
    -s, --show         print detailed info about reactor(s)
    -v, --verbose      enable more verbose output
    --silent           suppress all debug/info/warn/error log messages
```

The `kos` command-line utility internally uses the [run](../reactors/run.md) reactor to dynamically load reactor modules from the local filesystem.

### kos --show

The `--show` option provides a visual rendering of a reactor module.

The below output was generated by performing *introspection* of the [run](../reactors/run.md) reactor used by the `kos` utility.

```bash
$ kos --show run
run: reactions to runtime context
├─ id: 8c2054f0-f8eb-4a29-af89-3c906ce97ae3
├─ passive: false
├─ requires
│  ├─ module/fs
│  ├─ module/path
│  ├─ module/readline
│  ├─ module/treeify
│  ├─ process
│  └─ show
├─ reactors
│  └─ render
├─ triggers
│  ├─ ƒ(initialize)     @ 39f1acf5-6bf0-4fe6-ad20-ca843cbad46e
│  ├─ ƒ(start)          @ b2f3970e-b515-483c-885e-912b21a6b9a4
│  ├─ ƒ(promptUser)     @ 20f3853c-4dbf-4a42-b6f9-61b805d8da5b
│  ├─ ƒ(loadReactor)    @ f43e9a95-1fef-4db2-8e55-523d052f81ea
│  ├─ ƒ(updateLoadPath) @ 131342e1-45fc-4f09-b174-a3448ec4efe7
│  ├─ ƒ(tryRequire)     @ 36faa6c9-4725-4bf6-9f0d-e71aa5d031ab
│  ├─ ƒ(readKSONFile)   @ 9abb5a9d-f8d9-4439-86a7-cca39e50b9ad
│  ├─ ƒ(requireReactor) @ d5dd34b0-ded3-499c-a305-fe8400792a84
│  └─ ƒ(renderReactor)  @ 363a2db8-6b2e-4508-ba00-31b93d5e9640
└──┐
   ├─ render: reactions to visually render KOS reactors
   │  ├─ id: e383b95b-b282-4bad-812c-ac51f2438338
   │  ├─ passive: false
   │  ├─ requires
   │  │  └─ module/treeify
   │  ├─ triggers
   │  │  ├─ ƒ(render)              @ 15270bd8-22cb-4ea4-9551-bf47254b3f32
   │  │  ├─ ƒ(renderReactorAsTree) @ e9dbc219-48fa-4315-ad78-8631e6047f15
   │  │  └─ ƒ(outputTreeReactor)   @ 20d1d26e-b7cb-4449-b586-7fd9f1bfaa8a
   │  └──┐
   │     ├─╼ render         ╾─╼ ƒ(render)              ╾┬╼ render/reactor
   │     │                                              └╼ render/output 
   │     ├┬╼ module/treeify ╾┬╼ ƒ(renderReactorAsTree) ╾─╼ reactor/tree  
   │     │└╼ render/reactor ╾┘                          
   │     └┬╼ reactor/tree   ╾┬╼ ƒ(outputTreeReactor)  
   │      └╼ render/output  ╾┘                          
   │
   ├─╼ process         ╾─╼ ƒ(initialize)     ╾─╼ reactor 
   │                                          ┌╼ load    
   ├┬╼ program         ╾┬╼ ƒ(start)          ╾┼╼ read    
   │└╼ process         ╾┘                     ├╼ show    
   │                                          └╼ prompt  
   │┌╼ process         ╾┐                     
   ├┼╼ module/readline ╾┼╼ ƒ(promptUser)     ╾─╼ render  
   │└╼ prompt          ╾┘                     
   ├┬╼ module/path     ╾┬╼ ƒ(loadReactor)    ╾─╼ reactor 
   │└╼ load            ╾┘                     
   ├─╼ load/path       ╾─╼ ƒ(updateLoadPath)
   ├─╼ require         ╾─╼ ƒ(tryRequire)     ╾─╼ module/*
   ├┬╼ module/fs       ╾┬╼ ƒ(readKSONFile)  
   │└╼ read            ╾┘                     
   ├─╼ reactor         ╾─╼ ƒ(requireReactor) ╾─╼ require 
   │┌╼ process         ╾┐                     
   └┼╼ show            ╾┼╼ ƒ(renderReactor)  ╾─╼ render  
    └╼ reactor         ╾┘                     
```

Using the `--show` option, you can easily extract useful information regarding data objects that the reactor `requires`, the various `triggers` and `reactors` contained inside the reactor, as well as `inputs` and `outputs` for each of the reactions.
